<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dev Template | Desktop/Quest</title>
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="16x16" crossorigin="anonymous" href="assets/img/favicon.ico"/>
<link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png">
<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-touch-icon.png">
<link rel="mask-icon" href="assets/img/safari-pinned-tab.svg" color="#5bbad5">
<!-- TBD
<link rel="manifest" href="./site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
-->
<!-- Search Info -->
<meta name="description" content="Dev Template | Desktop/Quest">
<meta name="keywords" content="A-Frame,aframe,xr,webxr,vr,webvr,ar, webar,html,css,javascript,3d,blender,prototype,prototypes,virtual,reality,virtualreality,animation,animations,articles,blog,minty,crisp,mintycrisp,minty-crisp,minty_crisp,justin,ekema,justinekema">
<!-- Social Media Share -->
<meta property="og:title" content="Dev Template | Desktop/Quest">
<meta property="og:type" content="XR">
<meta property="og:url" content="mintycrisp.com">
<!-- TBD
<meta property="og:image" content="assets/img/share.jpg">
-->
<!-- A-Frame official release 1.3.0 -->
<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
<!-- MVP.css -->
<link rel="stylesheet" href="assets/css/mvp.css">
<!-- Main CSS
<link rel="stylesheet" href="assets/css/style.css"> -->
</head>

<!-- Add-on CSS -->
<style>

html {
scroll-behavior: smooth;
}

body {
background-color: #C14B76;
background-image: url(assets/img/bkgd-tex.png);
background-repeat: repeat;
}

header {
padding-bottom: 0;
}

.sticky {
position: -webkit-sticky;
position: sticky;
top: 0;
z-index: 100;
}

.flexRow {
display: flex;
flex-direction: row;
justify-content: space-between;
}

.flexStart {
justify-content: flex-start;
}

.flexCol {
display: flex;
flex-direction: column;
justify-content: center;
}

#stickyBar {
padding: 0.25em;
background-color: #3EB489;
height: 2.75em;
}

#stickyTitle h5 {
margin-bottom: 0;
margin-left: 0.25em;
--color: var(--h1-color);
justify-content: flex-start;
}

#sticky3D, #stickySwapControls {
padding: 0.9em;
background-color: #C14B76;
}

#stickyTheme {
margin-bottom: 0;

}

#stickyIcon {
background-color: var(--background-color);
border-radius: 50%;
}

#contactButton {
display: flex;
justify-content: center;
}

:root {
    --active-brightness: 0.85;
    --border-radius: 5px;
    --box-shadow: 2px 2px 10px;
    --color-accent: #118bee15;
    --color-bg: #fff;
    --color-bg-secondary: #e9e9e9;
    --color-link: #3EB489;
    --color-secondary: #f2849e;
    --color-secondary-accent: #920de90b;
    --color-shadow: #f4f4f4;
    --color-table: #118bee;
    --color-text: #000;
    --color-text-secondary: #999;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    --hover-brightness: 1.2;
    --justify-important: center;
    --justify-normal: left;
    --line-height: 1.5;
    --width-card: 420px;
    --width-card-medium: 460px;
    --width-card-wide: 800px;
    --width-content: 1080px;
}
/*
Green
#3EB489
Pink
#C14B76
alt-pink
#f2849e
White Text
#e5e2e2
Lite Grey Text
#c4c3c3
Dark Text
#3e3d3d
Darker Text (Smaller)
#2f2e2e
*/
</style>

<script>
//
//Dev | Desktop <-> VR Controller Control Swap Component
AFRAME.registerComponent('swap-controls', {
//schema: {
	//bar: {type: 'number'},
	//baz: {type: 'string'}
//},

init: function () {
//Do something when component first attached.
//Called once when the component is initialized. Used to set up initial state and instantiate variables.
const stickySwapControls = document.querySelector('#stickySwapControls');
const player = document.querySelector('#player');
const camera = document.querySelector('#camera');
const cameraUI = document.querySelector('#cameraUI');
const playerFloor = document.querySelector('#playerFloor');
const mouseController = document.querySelector('#mouseController');
const vrController = document.querySelector('#vrController');
const vrControllerUI = document.querySelector('#vrControllerUI');
let vrControls = false;

function swapControls(){

if(vrControls){
	//VR to Desktop

	//Disable VR Controls
	//vrController visible to true
	vrController.setAttribute('visible',false);
	//vrControllerUI visible to true
	vrControllerUI.setAttribute('visible',false);
	//vrController cursor property
	vrController.removeAttribute('cursor');
	//vrController raycaster property
	vrController.removeAttribute('raycaster');
	//vrController laser-controls property
	vrController.removeAttribute('laser-controls');

	//Enable Desktop Controls
	//Remove Desktop WASD Controls
	player.setAttribute('wasd-controls',{enabled: 'true', acceleration: 25});
	//Set mouseController to invisible
	mouseController.setAttribute('visible',true);
	//Set mouseController raycaster to false
	mouseController.setAttribute('raycaster',{enabled: 'true', autoRefresh: 'true', objects: '.clickable', far: 'Infinity', near: 0, interval: 0, lineColor: 'red', lineOpacity: 0.5, showLine: 'false', useWorldCoordinates: 'false'});
	//Remove cursor attribute
	mouseController.setAttribute('cursor',{fuse: 'false', rayOrigin: 'mouseController', mouseCursorStylesEnabled: 'true'});

	//Set HTML UI
	stickySwapControls.innerHTML = "Controls:Desktop";

	//VR Controls are Off
	vrControls = false;
} else {
	//Desktop to VR

	//Disable Desktop Controls
	//Remove Desktop WASD Controls
	player.removeAttribute('wasd-controls');
	//Set mouseController to invisible
	mouseController.setAttribute('visible',false);
	//Set mouseController raycaster to false
	mouseController.removeAttribute('raycaster');
	//Remove cursor attribute
	mouseController.removeAttribute('cursor');

	//Enable VR Controls
	//vrController visible to true
	vrController.setAttribute('visible',true);
	//vrControllerUI visible to true
	vrControllerUI.setAttribute('visible',true);
	//vrController raycaster property
	vrController.setAttribute('raycaster',{enabled: 'true', autoRefresh: 'true', objects: '.clickable', far: 'Infinity', near: 0, interval: 0, lineColor: 'red', lineOpacity: 0.5, showLine: 'true', useWorldCoordinates: 'false'});
	//vrController cursor property
	vrController.setAttribute('cursor',{fuse: 'false', rayOrigin: 'vrController', mouseCursorStylesEnabled: 'true'});
	//vrController laser-controls property
	vrController.setAttribute('laser-controls',{hand: 'right'});

	//Set HTML UI
	stickySwapControls.innerHTML = "Controls:VR";

	//VR Controls are On
	vrControls = true;
}


}//End Swap Controls


stickySwapControls.addEventListener('click', swapControls);


    }//End Init
});

//
//Dev - Detect Inputs
AFRAME.registerComponent('detect-inputs', {
//schema: {
	//bar: {type: 'number'},
	//baz: {type: 'string'}
//},

init: function () {
//Do something when component first attached.
//Called once when the component is initialized. Used to set up initial state and instantiate variables.

//Display Input Selections
//HMD View - Mouse Movement
//Main Trigger Click - Mouse Left Click
//Secondary Trigger Click - Mouse Right Click
//Joystick Directional - WASD
//Button 1 - Q
//Button 2 - E

const displayInput = document.querySelector('#displayInput');

let displayInputText = {value: 'No Input', color: 'white', align: 'center'}

function updateInput(input){

displayInputText.value = input;
displayInput.setAttribute('text',displayInputText);

}


//
//Event Listeners

//Desktop
//

//Mouse
//
//Left Click
document.body.addEventListener('click', function (e) {
	updateInput('main click');
});
//
//Right Click
document.body.addEventListener('contextmenu', function (e) {
	updateInput('secondary click');
});

//Keyboard
//
//Key Down - WASD | QE
document.body.addEventListener('keydown', function (e) {
	if (e.key === 'w' || e.key === 'W') {
		//Start moving player
		updateInput('up');
	} else if (e.key === 'a' || e.key === 'A') {
		//Start moving player
		updateInput('left');
	} else if (e.key === 's' || e.key === 'S') {
		//Start moving player
		updateInput('down');
	} else if (e.key === 'd' || e.key === 'D') {
		//Start moving player
		updateInput('right');
	} else if (e.key === 'q' || e.key === 'Q') {
		//Start moving player
		updateInput('button 1');
	} else if (e.key === 'e' || e.key === 'E') {
		//Start moving player
		updateInput('button 2');
	}
});//End keydown


//Quest
//

//Triggers
//
//Main Trigger
document.body.addEventListener('triggerdown', function (e) {
	updateInput('main trigger');
});

//
//Secondary Trigger
document.body.addEventListener('gripdown', function (e) {
	updateInput('secondary trigger');
});

//Buttons
//
//Right Controller - Button 1 (A)
document.body.addEventListener('abuttondown', function (e) {
	updateInput('button 1');
});
//
//Right Controller - Button 2 (B)
document.body.addEventListener('bbuttondown', function (e) {
	updateInput('button 2');
});
//
//Left Controller - Button 1 (X)
document.body.addEventListener('xbuttondown', function (e) {
	updateInput('button 1');
});
//
//Left Controller - Button 2 (Y)
document.body.addEventListener('ybuttondown', function (e) {
	updateInput('button 2');
});

//Joystick
//
//Left Controller
document.body.addEventListener('thumbstickmoved', function (e) {
	if (evt.detail.y > 0.95) { 
		updateInput('down')
	}
	if (evt.detail.y < -0.95) { 
		updateInput('up')
	}
	if (evt.detail.x < -0.95) { 
		updateInput('left')
	}
	if (evt.detail.x > 0.95) { 
		updateInput('right')
	}
});



    }//End Init
});
</script>

<body>

<!-- Sticky -->
<div id="stickyBar" class="sticky flexRow">
	<span class="flexRow flexStart">
		<img id="stickyIcon" src="assets/img/logo.png" alt="site-icon" / class="flexCol">
		<span id="stickyTitle" class="flexCol"><h3>Dev Template | Desktop/Quest</h3></span>
	</span>
	<span class="flexRow">
		<button id="stickySwapControls" class="flexCol">Desktop:Enabled</button>
		<button id="sticky3D" class="flexCol">VR</button>
	</span>
</div>

<!-- Main -->
<main>

<a-scene
swap-controls
detect-inputs
background="color: #C14B76"
vr-mode-ui="enabled: true; enterVRButton: #sticky3D;"
renderer="antialias: true; colorManagement: true; sortObjects: true"
>
<!-- - - - - - - - - - - Assets - - - - - - - - - - -->
<a-assets timeout="3000">

    <!-- - - - - - - - - - - Timeline - - - - - - - - - - -->

    <!-- - - - - - - - - - - Mixins - - - - - - - - - - -->
<a-mixin id="clickAnimation"

animation__click="property: scale; from: 0.75 0.75 0.75; to: 0.05 0.05 0.05; dur: 250; delay: 0; loop: false; dir: normal; easing: easeInCubic; elasticity: 400; autoplay: false; enabled: true; startEvents: click;"

animation__mousereset="property: scale; to: 0.75 0.75 0.75; dur: 250; delay: 500; loop: false; dir: normal; easing: easeOutCubic; elasticity: 400; autoplay: false; enabled: true; startEvents: click;"
></a-mixin>
</a-assets>

<!-- - - - - - - - - - - Scene - - - - - - - - - - -->

<!-- Main Screen -->
<a-curvedimage id="mainScreen" class="clickable"
height="1.75" radius="1.5"
position="0 2 -2" rotation="0 0 0" scale="3 3 3"
theta-length="00" theta-start="120"

material="color: black; side: double; shader: flat; opacity: 0.15"

animation__popin120="property: theta-length; from: 0; to: 120; dur: 2000; delay: 0; loop: false; dir: normal; easing: easeInOutElastic; elasticity: 400; autoplay: true; enabled: true;"
></a-curvedimage>

<!-- Display Input -->
<a-entity id="displayInput"
position="0 1 -2" rotation="-45 0 0"
geometry="primitive: plane; width: 2; height: 0.6;"
material="color: #304a39; shader: flat; opacity: 0.69; side: double"
text="value: No Input; color: white; align: center;"
>
<a-text
value="Display Input"
color="white" align="center" width="1.4" position="0 0.225 0"
></a-text></a-entity>


<!-- Floor -->
<a-circle id="floor" visible="true"
rotation="-90 0 0" radius="42" position="0 -0.8 0"
material="shader: flat; color: #2e8666; side: both; opacity: 1"
></a-circle> 

<!-- - - - - - - - - - - Player Controls - - - - - - - - - - -->
<!-- Desktop Mode | Default -->
<!-- Player -->
<a-entity id="player" position="0 0 0"
wasd-controls="enabled: true; acceleration: 25;"
>
    <!-- Player Head | Rotation -->
    <a-camera id="camera"
    position="0 1.6 0"
    look-controls="pointerLockEnabled: false"
	wasd-controls="enabled: false;"
    >
        <a-entity id="mouseController" visible="true"
		mixin="clickAnimation"
        position="0 0 -0.5"
        scale="0.75 0.75 0.75"
        geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
        material="color: grey; shader: flat; side: double"

        raycaster="enabled: true; autoRefresh: true; objects: .clickable; origin: 0, 0, 0; direction: 0, 0, -1; far: Infinity; near: 0; interval: 0; lineColor: red; lineOpacity: 0.5; showLine: false; useWorldCoordinates: false"

        cursor="fuse: false; rayOrigin: mouseController; mouseCursorStylesEnabled: true;"

        ></a-entity>

        <!-- Camera UI -->
        <a-entity id="cameraUI"
        scale="0.5 0.5 0.5"
        geometry="primitive: plane; width: 0.25; height: 0.1;"
        position="-0.15 -0.15 -0.25" rotation="0 0 0"
        material="color: #ac2d2d; shader: flat; opacity: 0.69; side: double"
        text="value: Camera UI; color: white; align: center; width:0.5"
        ></a-entity>

    </a-camera>

    <!-- Controller -->
	<a-entity id="vrController" visible="false"
    position="0 0 -1"
    rotation="0 0 0"
    scale="0.15 0.15 0.15"
    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
    material="color: grey; shader: flat; side: double"

	>
    <!-- Controller UI -->
    <!-- Test UI -->
    <a-entity id="vrControllerUI" visible="false"
    scale="0.5 0.5 0.5"
    geometry="primitive: plane; width: 0.25; height: 0.1;"
    position="-0.15 -0.15 -0.25" rotation="0 0 0"
    material="color: #ac2d2d; shader: flat; opacity: 0.69; side: double"
    text="value: Controller UI; color: white; align: center; width:0.5"
    ></a-entity>
    </a-entity>

	<!-- Player Floor -->
	<a-circle id="playerFloor" visible="true"
	rotation="-90 0 0" radius="1" position="0 0.05 0"
	material="shader: flat; color: #3EB489; side: both; opacity: 0.75"
	></a-circle>

</a-entity>


<!-- - - - - - - - - - - Lights - - - - - - - - - - -->
<!-- Lights -->
<!-- Directional -->
<a-entity id="directionalLight"
light="type: directional; intensity: 0.5; castShadow: false" position="0 0.65 0.25"
></a-entity> 
<!-- Ambient -->
<a-entity id="ambientLight"
light="type: ambient; color: #716a9a; intensity: 0.5"
></a-entity> 
</a-scene>




</main>

</body>

</html>
